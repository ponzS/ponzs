import{n as V,o as l,E as $,t as w,u as f,v as a,B as u,F as x,G as I,H as q,A as R,x as v,z as c,C as _,_ as U}from"./index-kw_B4tjD.js";import{a as g}from"./axios-upsvKRUO.js";const B={class:"reset-password-container"},D={class:"reset-password-form"},E={class:"logo"},N={style:{"font-size":"20px","font-weight":"bold"}},z={key:0,class:"error-message"},L={type:"submit",class:"btn-animate"},S=["disabled"],T={key:0,class:"message"},P="http://ponzs.com",M=V({__name:"reset-password",setup(A){const b=l({email:""}),s=l({email:"",token:"",newPassword:"",confirmPassword:""}),r=l(""),i=l(!1),p=l(60);let m=null;const d=l(""),k=async()=>{var t,e;if(!i.value)try{const o=await g.post(`${P}/api/auth/send-verification-code`,{email:b.value.email});r.value=o.data.message,h()}catch(o){r.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"发送验证码失败"}},h=()=>{i.value=!0,p.value=60,m=setInterval(()=>{p.value>0?p.value--:(m&&clearInterval(m),i.value=!1)},1e3)},y=()=>{s.value.newPassword!==s.value.confirmPassword?d.value="两次输入的密码不一致":d.value=""},C=async()=>{var t,e;if(s.value.newPassword!==s.value.confirmPassword){d.value="两次输入的密码不一致";return}try{const o=await g.post(`${P}/api/auth/reset-password`,s.value);r.value=o.data.message}catch(o){r.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"重置密码失败"}};return(t,e)=>{const o=$("RouterLink");return w(),f("div",B,[e[4]||(e[4]=a("div",{class:"aurora-layer aurora-layer1"},null,-1)),e[5]||(e[5]=a("div",{class:"aurora-layer aurora-layer2"},null,-1)),a("div",D,[a("div",E,[a("h2",N,u(t.$t("routes.reset-password")),1)]),x(o,{to:"/login",class:"back-button"},{default:I(()=>[q("← "+u(t.$t("routes.login")),1)]),_:1}),a("form",{onSubmit:R(C,["prevent"])},[v(a("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.value.email=n),type:"email",placeholder:"Email",required:"",class:"input-animate"},null,512),[[c,s.value.email]]),v(a("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>s.value.token=n),type:"text",placeholder:"Reset Token",required:"",class:"input-animate"},null,512),[[c,s.value.token]]),v(a("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>s.value.newPassword=n),type:"password",placeholder:"新密码",required:"",class:"input-animate",onInput:y},null,544),[[c,s.value.newPassword]]),v(a("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.value.confirmPassword=n),type:"password",placeholder:"确认新密码",required:"",class:"input-animate",onInput:y},null,544),[[c,s.value.confirmPassword]]),d.value?(w(),f("div",z,u(d.value),1)):_("",!0),a("button",L,u(t.$t("routes.reset-password")),1)],32),a("button",{disabled:i.value,onClick:k,class:"btn-animate"},u(i.value?`请等待 ${p.value} 秒`:t.$t("routes.send-code")),9,S),r.value?(w(),f("div",T,u(r.value),1)):_("",!0)])])}}}),H=U(M,[["__scopeId","data-v-786e3933"]]);export{H as default};
