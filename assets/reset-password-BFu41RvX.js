import{d as C,r as l,h as $,a as w,c as f,b as a,t as i,i as I,j as q,k as x,f as R,w as c,e as v,g as _,_ as U}from"./index-JDhQ3JDR.js";import{a as g}from"./axios-upsvKRUO.js";const D={class:"reset-password-container"},N={class:"reset-password-form"},B={class:"logo"},E={style:{"font-size":"20px","font-weight":"bold"}},L={key:0,class:"error-message"},S={type:"submit",class:"btn-animate"},T=["disabled"],z={key:0,class:"message"},b="http://ponzs.com",M=C({__name:"reset-password",setup(j){const k=l({email:""}),s=l({email:"",token:"",newPassword:"",confirmPassword:""}),n=l(""),u=l(!1),p=l(60);let m=null;const d=l(""),P=async()=>{var t,e;if(!u.value)try{const o=await g.post(`${b}/api/auth/send-verification-code`,{email:k.value.email});n.value=o.data.message,h()}catch(o){n.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"发送验证码失败"}},h=()=>{u.value=!0,p.value=60,m=setInterval(()=>{p.value>0?p.value--:(m&&clearInterval(m),u.value=!1)},1e3)},y=()=>{s.value.newPassword!==s.value.confirmPassword?d.value="两次输入的密码不一致":d.value=""},V=async()=>{var t,e;if(s.value.newPassword!==s.value.confirmPassword){d.value="两次输入的密码不一致";return}try{const o=await g.post(`${b}/api/auth/reset-password`,s.value);n.value=o.data.message}catch(o){n.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"重置密码失败"}};return(t,e)=>{const o=$("RouterLink");return w(),f("div",D,[e[4]||(e[4]=a("div",{class:"aurora-layer aurora-layer1"},null,-1)),e[5]||(e[5]=a("div",{class:"aurora-layer aurora-layer2"},null,-1)),a("div",N,[a("div",B,[a("h2",E,i(t.$t("routes.reset-password")),1)]),I(o,{to:"/login",class:"back-button"},{default:q(()=>[x("← "+i(t.$t("routes.login")),1)]),_:1}),a("form",{onSubmit:R(V,["prevent"])},[c(a("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.value.email=r),type:"email",placeholder:"Email",required:"",class:"input-animate"},null,512),[[v,s.value.email]]),c(a("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.value.token=r),type:"text",placeholder:"Reset Token",required:"",class:"input-animate"},null,512),[[v,s.value.token]]),c(a("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.value.newPassword=r),type:"password",placeholder:"新密码",required:"",class:"input-animate",onInput:y},null,544),[[v,s.value.newPassword]]),c(a("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>s.value.confirmPassword=r),type:"password",placeholder:"确认新密码",required:"",class:"input-animate",onInput:y},null,544),[[v,s.value.confirmPassword]]),d.value?(w(),f("div",L,i(d.value),1)):_("",!0),a("button",S,i(t.$t("routes.reset-password")),1)],32),a("button",{disabled:u.value,onClick:P,class:"btn-animate"},i(u.value?`请等待 ${p.value} 秒`:t.$t("routes.send-code")),9,T),n.value?(w(),f("div",z,i(n.value),1)):_("",!0)])])}}}),G=U(M,[["__scopeId","data-v-786e3933"]]);export{G as default};
