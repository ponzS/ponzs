import{n as b,o as a,q as x,t as n,u as r,v as t,x as f,y as g,z as S,A as w,B as v,C as I}from"./index-kw_B4tjD.js";import{A as U}from"./config-DaGrT2J7.js";const k={class:"container mx-auto p-4"},C={key:0},B={key:0,class:"text-red-500 mt-4"},D={key:1,class:"text-center"},M=b({__name:"verify",setup(N){const i=a(""),d=a("type1"),s=a(""),u=a(!1),o=a(null);async function m(){try{const e=await(await fetch(`${U}/cards/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:i.value,type:d.value})})).json();e.success?(u.value=!0,o.value=e.card,localStorage.setItem("cardInfo",JSON.stringify({type:e.card.type,validUntil:e.card.validUntil}))):s.value=e.message}catch(l){console.error("Error verifying card:",l),s.value="验证失败，请重试"}}return x(()=>{const l=localStorage.getItem("cardInfo");if(l){const e=JSON.parse(l);new Date(e.validUntil)>new Date?(u.value=!0,o.value=e):localStorage.removeItem("cardInfo")}}),(l,e)=>{var c,y;return n(),r("div",k,[u.value?(n(),r("div",D,[e[7]||(e[7]=t("h2",{class:"text-2xl text-green-500"},"卡密验证成功！",-1)),t("p",null,"类型: "+v((c=o.value)==null?void 0:c.type),1),t("p",null,"有效期至: "+v((y=o.value)!=null&&y.validUntil?new Date(o.value.validUntil).toLocaleString():""),1)])):(n(),r("div",C,[e[6]||(e[6]=t("h1",{class:"text-2xl mb-4"},"验证卡密",-1)),t("form",{onSubmit:w(m,["prevent"]),class:"space-y-4"},[t("div",null,[e[3]||(e[3]=t("label",{class:"block mb-2"},"选择类型",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=p=>d.value=p),class:"w-full p-2 border rounded"},e[2]||(e[2]=[t("option",{value:"type1"},"类型1",-1),t("option",{value:"type2"},"类型2",-1),t("option",{value:"type3"},"类型3",-1)]),512),[[g,d.value]])]),t("div",null,[e[4]||(e[4]=t("label",{class:"block mb-2"},"输入卡密",-1)),f(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=p=>i.value=p),class:"w-full p-2 border rounded"},null,512),[[S,i.value]])]),e[5]||(e[5]=t("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"}," 验证卡密 ",-1))],32),s.value?(n(),r("p",B,v(s.value),1)):I("",!0)]))])}}});export{M as default};
