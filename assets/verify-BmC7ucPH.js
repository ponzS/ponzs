import{d as b,r as o,o as x,a as n,c as r,b as t,w as y,v as g,e as S,f as w,t as v,g as I}from"./index-JDhQ3JDR.js";import{A as U}from"./config-DaGrT2J7.js";const k={class:"container mx-auto p-4"},C={key:0},D={key:0,class:"text-red-500 mt-4"},N={key:1,class:"text-center"},O=b({__name:"verify",setup(V){const i=o(""),d=o("type1"),s=o(""),u=o(!1),a=o(null);async function m(){try{const e=await(await fetch(`${U}/cards/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:i.value,type:d.value})})).json();e.success?(u.value=!0,a.value=e.card,localStorage.setItem("cardInfo",JSON.stringify({type:e.card.type,validUntil:e.card.validUntil}))):s.value=e.message}catch(l){console.error("Error verifying card:",l),s.value="验证失败，请重试"}}return x(()=>{const l=localStorage.getItem("cardInfo");if(l){const e=JSON.parse(l);new Date(e.validUntil)>new Date?(u.value=!0,a.value=e):localStorage.removeItem("cardInfo")}}),(l,e)=>{var c,f;return n(),r("div",k,[u.value?(n(),r("div",N,[e[7]||(e[7]=t("h2",{class:"text-2xl text-green-500"},"卡密验证成功！",-1)),t("p",null,"类型: "+v((c=a.value)==null?void 0:c.type),1),t("p",null,"有效期至: "+v((f=a.value)!=null&&f.validUntil?new Date(a.value.validUntil).toLocaleString():""),1)])):(n(),r("div",C,[e[6]||(e[6]=t("h1",{class:"text-2xl mb-4"},"验证卡密",-1)),t("form",{onSubmit:w(m,["prevent"]),class:"space-y-4"},[t("div",null,[e[3]||(e[3]=t("label",{class:"block mb-2"},"选择类型",-1)),y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=p=>d.value=p),class:"w-full p-2 border rounded"},e[2]||(e[2]=[t("option",{value:"type1"},"类型1",-1),t("option",{value:"type2"},"类型2",-1),t("option",{value:"type3"},"类型3",-1)]),512),[[g,d.value]])]),t("div",null,[e[4]||(e[4]=t("label",{class:"block mb-2"},"输入卡密",-1)),y(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=p=>i.value=p),class:"w-full p-2 border rounded"},null,512),[[S,i.value]])]),e[5]||(e[5]=t("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"}," 验证卡密 ",-1))],32),s.value?(n(),r("p",D,v(s.value),1)):I("",!0)]))])}}});export{O as default};
