import{n as B,o as l,t as w,u as f,v as R,x as _,y as g,z as a,F as u,I as U,B as D,C as c,E as v,A as k,G as P,_ as E}from"./index-B_Ia2wqB.js";import{a as b}from"./axios-upsvKRUO.js";const N={class:"reset-password-container"},z={class:"reset-password-form"},L={class:"logo"},S={style:{"font-size":"20px","font-weight":"bold"}},T={key:0,class:"error-message"},M={type:"submit",class:"btn-animate"},A=["disabled"],F={key:0,class:"message"},h="http://ponzs.com",G=B({__name:"reset-password",setup(j){const C=l({email:""}),s=l({email:"",token:"",newPassword:"",confirmPassword:""}),r=l(""),i=l(!1),p=l(60);let m=null;const d=l(""),V=async()=>{var t,e;if(!i.value)try{const o=await b.post(`${h}/api/auth/send-verification-code`,{email:C.value.email});r.value=o.data.message,I()}catch(o){r.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"发送验证码失败"}},I=()=>{i.value=!0,p.value=60,m=setInterval(()=>{p.value>0?p.value--:(m&&clearInterval(m),i.value=!1)},1e3)},y=()=>{s.value.newPassword!==s.value.confirmPassword?d.value="两次输入的密码不一致":d.value=""},$=async()=>{var t,e;if(s.value.newPassword!==s.value.confirmPassword){d.value="两次输入的密码不一致";return}try{const o=await b.post(`${h}/api/auth/reset-password`,s.value);r.value=o.data.message}catch(o){r.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"重置密码失败"}};return(t,e)=>{const o=w("RouterLink"),x=w("ion-content"),q=w("ion-page");return f(),R(q,null,{default:_(()=>[g(x,null,{default:_(()=>[a("div",N,[e[4]||(e[4]=a("div",{class:"aurora-layer aurora-layer1"},null,-1)),e[5]||(e[5]=a("div",{class:"aurora-layer aurora-layer2"},null,-1)),a("div",z,[a("div",L,[a("h2",S,u(t.$t("routes.reset-password")),1)]),g(o,{to:"/login",class:"back-button"},{default:_(()=>[U("← "+u(t.$t("routes.login")),1)]),_:1}),a("form",{onSubmit:D($,["prevent"])},[c(a("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.value.email=n),type:"email",placeholder:"Email",required:"",class:"input-animate"},null,512),[[v,s.value.email]]),c(a("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>s.value.token=n),type:"text",placeholder:"Reset Token",required:"",class:"input-animate"},null,512),[[v,s.value.token]]),c(a("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>s.value.newPassword=n),type:"password",placeholder:"新密码",required:"",class:"input-animate",onInput:y},null,544),[[v,s.value.newPassword]]),c(a("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.value.confirmPassword=n),type:"password",placeholder:"确认新密码",required:"",class:"input-animate",onInput:y},null,544),[[v,s.value.confirmPassword]]),d.value?(f(),k("div",T,u(d.value),1)):P("",!0),a("button",M,u(t.$t("routes.reset-password")),1)],32),a("button",{disabled:i.value,onClick:V,class:"btn-animate"},u(i.value?`请等待 ${p.value} 秒`:t.$t("routes.send-code")),9,A),r.value?(f(),k("div",F,u(r.value),1)):P("",!0)])])]),_:1})]),_:1})}}}),K=E(G,[["__scopeId","data-v-4fd5e38e"]]);export{K as default};
